<% first_name = @customer&.first_name.presence || "there" %>
<% bags_per_delivery = @subscription.quantity.presence || @plan.bags_per_delivery %>

<h2 style="color: #111827; margin-top: 0;">Payment issue with your coffee subscription</h2>

<p>Hi <%= first_name %>,</p>

<p>We ran into a problem processing the payment for your <%= @plan.frequency.titleize %> &middot; <%= pluralize(bags_per_delivery, "bag") %> subscription.</p>

<p>No worries — this happens from time to time.</p>

<div style="background: #f3f4f6; padding: 18px; margin: 24px 0; border-radius: 8px; border: 1px solid #e5e7eb;">
  <p style="margin: 0 0 12px 0; font-weight: 600; color: #111827;">What you can do:</p>
  <ul style="margin: 0; padding-left: 20px; color: #374151;">
    <li>Check that your payment method is still valid</li>
    <li>Make sure your card hasn’t expired</li>
    <li>Update your payment details if needed</li>
  </ul>
</div>

<p>Once your payment method is updated, we’ll take care of the rest and continue your subscription as usual.</p>

<div style="text-align: center; margin: 32px 0;">
  <%= link_to "Update Payment Method", @update_payment_url, style: "display: inline-block; padding: 12px 24px; background-color: #d9a07b; color: #111827; text-decoration: none; border-radius: 6px; font-weight: 600;" %>
</div>

<p>If you have any questions or need help, just reply to this email and we’ll take care of it.</p>

<p style="margin-top: 24px;">
  —<br>
  Acer Coffee
</p>
